- name: "Install shell packages"
  aur:
    skip_installed: true
    name: "{{ item }}"
  become: true
  become_user: aur_builder
  when: "item not in installed_packages.stdout_lines"
  with_items:
    - 'advanced-ssh-config'
    - 'alacritty'
    - arch-install-scripts
    - 'bat'
    - 'catimg'
    - 'climate'
    - 'exa'
    - 'fasd'
    - 'fd'
    - 'htop'
    - 'jshon'
    - 'jq'
    - 'nnn'
    - 'oh-my-zsh-git'
    - 'perl-file-mimeinfo'
    - 'pigz'
    - 'playerctl'
    - 'reptyr'
    - 'ripgrep'
    - 'scrcpy'
    - 'screenfetch'
    - 'sl'
    - 'terminator'
    - 'thefuck'
    - 'tmux'
    - 'ruby-tmuxinator'
    - 'zsh'
    - 'zsh-completions'
    - 'zsh-doc'
    - 'zsh-syntax-highlighting'


- name: Install ZSH config
  template:
    src: ./files/zshrc/.zshrc
    dest: "{{ home }}/.zshrc"
    mode: 0644
    owner: "{{ user }}"
    validate: "zsh -n %s"
    backup: true
    trim_blocks: false

- name: Install global environmetn variables
  template:
    src: ./files/global-environment
    dest: /etc/environment
    mode: 0644
    owner: root
    group: root

- name: Install tmux config
  template:
    src: ./files/tmux.conf
    dest: "{{ home }}/.tmux.conf"
    mode: 0755
    owner: "{{ user }}"
    group: users

- name: Install tmux themepack
  git:
    repo: https://github.com/jimeh/tmux-themepack.git
    dest: "{{ home }}/.tmux/plugins/tmux-themepack"
    force: true
  become: true
  become_user: "{{ user }}"


- name: "Create alacritty config directory"
  file:
    path: '{{ home }}/.config/alacritty/'
    state: directory
    owner: "{{ user }}"
    mode: 0755

- name: "Create alacritty config"
  copy:
    src: './files/alacritty.yml'
    dest: '{{ home }}/.config/alacritty/alacritty.yml'
    mode: 0644
    owner: "{{ user }}"


- name: "Create terminator directory"
  file:
    path: '{{ home }}/.config/terminator/'
    state: directory
    owner: "{{ user }}"
    mode: 0755

- name: "Create alacritty config"
  copy:
    src: './files/terminator.conf'
    dest: '{{ home }}/.config/terminator/config'
    mode: 0644
    owner: "{{ user }}"

- name: Install tmuxinator config
  copy:
    src: ./files/tmuxinator
    dest: "{{ home }}/.config"
    mode: 0644
    owner: "{{ user }}"
    group: users
    directory_mode: 0755

- name: Set vconsole keyboard
  lineinfile:
    path: /etc/vconsole.conf
    state: present
    line: 'KEYMAP=uk'
    create: true
