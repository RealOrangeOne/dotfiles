- name: "Install DabApps packages"
  aur:
    skip_installed: true
    name: "{{ item }}"
  become: true
  become_user: aur_builder
  when: "item not in installed_packages.stdout_lines"
  with_items:
    - 'redis'
    - 'ngrok'


- name: "Enable redis"
  systemd:
    name: "redis"
    enabled: true
    state: started


- name: "Clone DabApps Dotfiles"
  git:
    repo: git@github.com:dabapps/dotfiles
    dest: "{{ home }}/Projects/dotfiles"
    force: true
  become: true
  become_user: "{{ user }}"

- name: "Install DabApps EditorConfig"
  file:
    src: "{{ home }}/Projects/dotfiles/.editorconfig"
    dest: "{{ home }}/Projects/.editorconfig"
    mode: 0644
    owner: "{{ user }}"
    state: link
    force: true
