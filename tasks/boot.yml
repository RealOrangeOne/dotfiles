- name: "Install Grub"
  aur:
    skip_installed: true
    name: "{{ item }}"
  become: true
  become_user: aur_builder
  when: "item not in installed_packages.stdout_lines"
  with_items:
    - 'grub-customizer'
    - 'grub2-theme-archlinux'
    - 'lightdm'
    - 'lightdm-slick-greeter'
    - 'os-prober'

- service:
    name: "lightdm"
    enabled: true

- modprobe:
    name: pcspkr
    state: absent

- name: Enable Slick greeter for lightdm
  ini_file:
    path: /etc/lightdm/lightdm.conf
    section: "Seat:*"
    option: greeter-session
    value: lightdm-slick-greeter
    mode: 0644

- name: Enable GB locale
  locale_gen:
    name: en_GB.UTF-8

- name: Set timezone
  timezone:
    name: Europe/London
